id: gitpull
namespace: github-pull

tasks:
  - id: sync_files
    type: io.kestra.plugin.git.SyncNamespaceFiles
    username: yashsinghhh
    password: "{{secret('GITHUB_ACCESS_TOKEN')}}"
    url: https://github.com/yashsinghhh/WinterHack-Kestra.git
    branch: main
    namespace: dev
    gitDirectory: .
    dryRun: false

#   - id: force_fail
#     type: io.kestra.plugin.scripts.shell.Commands
#     runner: PROCESS
#     commands:
#       - exit 1 


# errors:
#   - id: send_email
#     type: io.kestra.plugin.notifications.mail.MailSend
#     from: kestra.app@gmail.com
#     to: yashsingh0666@gmail.com
#     username: "{{ secret('EMAIL_USERNAME') }}"
#     password: "{{ secret('EMAIL_PASSWORD') }}"
#     host: smtp.gmail.com
#     port: 465 # or 587
#     subject: "Kestra workflow failed for the flow {{flow.id}} in the namespace {{flow.namespace}}"
#     htmlTextContent: "Failure alert for flow {{ flow.namespace }}.{{ flow.id }} with ID {{ execution.id }}"

triggers:
  - id: gh_webhook
    type: io.kestra.plugin.core.trigger.Webhook
    key: abcdefg


//check1 failed as content type of the webhook was not json
//check2 passed - checking again 